{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 7, "column": 0}, "map": {"version":3,"sources":["file:///Users/ashishyaduvanshi/Desktop/vibe-bites%201st%20Sep/client/app/login/page.js"],"sourcesContent":["'use client'\n\nimport React, { useState, useEffect } from 'react'\nimport { useRouter } from 'next/navigation'\nimport Link from 'next/link'\nimport Image from 'next/image'\nimport { Eye, EyeOff, Mail, Lock, User } from 'lucide-react'\nimport { useToast } from '../../components/Toaster'\n\nconst LoginPage = () => {\n  const [formData, setFormData] = useState({\n    email: '',\n    password: ''\n  })\n  const [showPassword, setShowPassword] = useState(false)\n  const [isLoading, setIsLoading] = useState(false)\n  const [isRegistering, setIsRegistering] = useState(false)\n  const router = useRouter()\n  const { addToast } = useToast()\n\n  // Remove localStorage token check, rely on cookie-based auth\n\n  const handleInputChange = (e) => {\n    setFormData({\n      ...formData,\n      [e.target.name]: e.target.value\n    })\n  }\n\n  const handleSubmit = async (e) => {\n    e.preventDefault()\n    setIsLoading(true)\n\n    try {\n      const endpoint = isRegistering ? '/auth/register' : '/auth/login'\n      const response = await fetch(`${process.env.NEXT_PUBLIC_API_URL || 'http://localhost:8080/api'}${endpoint}`, {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify(formData),\n        credentials: 'include'\n      })\n\n      const data = await response.json().catch(() => ({}))\n\n      if (response.ok && data.success) {\n        addToast(\n          isRegistering\n            ? 'Registration successful! Please check your email for verification.'\n            : 'Login successful!',\n          'success'\n        )\n        \n        // Store user data in localStorage for profile access\n        if (data.data && data.data.user) {\n          localStorage.setItem('user', JSON.stringify(data.data.user))\n          // If token is provided in response, store it too\n          if (data.token) {\n            localStorage.setItem('token', data.token)\n          }\n        }\n        \n        // Redirect based on user role\n        if (data.data.user.role === 'admin') router.push('/admin')\n        else router.push('/')\n      } else {\n        // Improved error surfacing\n        if (data?.errors?.length) {\n          data.errors.slice(0, 5).forEach(err => addToast(err.msg || err.message, 'error'))\n        } else if (data?.message) {\n          addToast(data.message, 'error')\n        } else {\n          addToast('Request failed. Check inputs.', 'error')\n        }\n        // Helpful hints for registration validation\n        if (isRegistering) {\n          const hints = []\n          if (!formData.firstName) hints.push('First name required')\n            if (!formData.lastName) hints.push('Last name required')\n            if (!/[A-Z]/.test(formData.password) || !/[a-z]/.test(formData.password) || !/\\d/.test(formData.password)) {\n              hints.push('Password needs uppercase, lowercase & number')\n            }\n          if (hints.length) {\n            hints.forEach(h => addToast(h, 'error'))\n          }\n        }\n      }\n    } catch (error) {\n      console.error('Auth error:', error)\n      addToast('Network error. Please try again.', 'error')\n    } finally {\n      setIsLoading(false)\n    }\n  }\n\n  const toggleMode = () => {\n    setIsRegistering(!isRegistering)\n    setFormData({ email: '', password: '' })\n  }\n\n  return (\n    <div className=\"min-h-screen bg-vibe-bg flex items-center justify-center py-12 px-4 sm:px-6 lg:px-8\">\n      <div className=\"max-w-md w-full space-y-8\">\n        <div className=\"text-center\">\n          <div className=\"flex justify-center\">\n            <div className=\"relative w-32 h-16\">\n              <Image src=\"/images/logo.jpeg\" alt=\"VIBE BITES\" fill className=\"object-contain\" priority />\n            </div>\n          </div>\n          <h2 className=\"mt-6 text-3xl font-bold text-vibe-brown\">{isRegistering ? 'Create Account' : 'Sign In'}</h2>\n          <p className=\"mt-2 text-sm text-gray-600\">{isRegistering ? 'Join VIBE BITES and discover amazing snacks!' : 'Welcome back to VIBE BITES!'}</p>\n        </div>\n\n        <div className=\"bg-white py-8 px-6 shadow-lg rounded-lg border border-vibe-cookie\">\n          <form className=\"space-y-6\" onSubmit={handleSubmit}>\n            {isRegistering && (\n              <div className=\"grid grid-cols-2 gap-4\">\n                <div>\n                  <label htmlFor=\"firstName\" className=\"block text-sm font-medium text-vibe-brown\">First Name</label>\n                  <div className=\"mt-1 relative\">\n                    <User className=\"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400\" />\n                    <input id=\"firstName\" name=\"firstName\" type=\"text\" required value={formData.firstName || ''} onChange={handleInputChange} className=\"appearance-none relative block w-full pl-10 pr-3 py-2 border border-vibe-cookie placeholder-gray-500 text-vibe-brown rounded-md focus:outline-none focus:ring-2 focus:ring-vibe-cookie focus:border-transparent\" placeholder=\"First Name\" />\n                  </div>\n                </div>\n                <div>\n                  <label htmlFor=\"lastName\" className=\"block text-sm font-medium text-vibe-brown\">Last Name</label>\n                  <div className=\"mt-1 relative\">\n                    <User className=\"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400\" />\n                    <input id=\"lastName\" name=\"lastName\" type=\"text\" required value={formData.lastName || ''} onChange={handleInputChange} className=\"appearance-none relative block w-full pl-10 pr-3 py-2 border border-vibe-cookie placeholder-gray-500 text-vibe-brown rounded-md focus:outline-none focus:ring-2 focus:ring-vibe-cookie focus:border-transparent\" placeholder=\"Last Name\" />\n                  </div>\n                </div>\n              </div>\n            )}\n            <div>\n              <label htmlFor=\"email\" className=\"block text-sm font-medium text-vibe-brown\">Email Address</label>\n              <div className=\"mt-1 relative\">\n                <Mail className=\"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400\" />\n                <input id=\"email\" name=\"email\" type=\"email\" autoComplete=\"email\" required value={formData.email} onChange={handleInputChange} className=\"appearance-none relative block w-full pl-10 pr-3 py-2 border border-vibe-cookie placeholder-gray-500 text-vibe-brown rounded-md focus:outline-none focus:ring-2 focus:ring-vibe-cookie focus:border-transparent\" placeholder=\"Enter your email\" />\n              </div>\n            </div>\n            <div>\n              <label htmlFor=\"password\" className=\"block text-sm font-medium text-vibe-brown\">Password</label>\n              <div className=\"mt-1 relative\">\n                <Lock className=\"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400\" />\n                <input id=\"password\" name=\"password\" type={showPassword ? 'text' : 'password'} autoComplete={isRegistering ? 'new-password' : 'current-password'} required value={formData.password} onChange={handleInputChange} className=\"appearance-none relative block w-full pl-10 pr-10 py-2 border border-vibe-cookie placeholder-gray-500 text-vibe-brown rounded-md focus:outline-none focus:ring-2 focus:ring-vibe-cookie focus:border-transparent\" placeholder=\"Enter your password\" />\n                <button type=\"button\" onClick={() => setShowPassword(!showPassword)} className=\"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600\">{showPassword ? (<EyeOff className=\"h-5 w-5\" />) : (<Eye className=\"h-5 w-5\" />)}</button>\n              </div>\n            </div>\n            {!isRegistering && (\n              <div className=\"flex items-center justify-between\">\n                <div className=\"flex items-center\">\n                  <input id=\"remember-me\" name=\"remember-me\" type=\"checkbox\" className=\"h-4 w-4 text-vibe-cookie focus:ring-vibe-cookie border-gray-300 rounded\" />\n                  <label htmlFor=\"remember-me\" className=\"ml-2 block text-sm text-gray-900\">Remember me</label>\n                </div>\n                <div className=\"text-sm\">\n                  <Link href=\"/forgot-password\" className=\"font-medium text-vibe-cookie hover:text-vibe-brown\">\n                    Forgot your password?\n                  </Link>\n                </div>\n              </div>\n            )}\n            <div>\n              <button type=\"submit\" disabled={isLoading} className=\"group relative w-full flex justify-center py-2 px-4 border border-transparent text-sm font-medium rounded-md text-white bg-vibe-cookie hover:bg-vibe-brown focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-vibe-cookie disabled:opacity-50 disabled:cursor-not-allowed transition-colors\">\n                {isLoading ? (<div className=\"flex items-center\"><div className=\"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2\"></div>{isRegistering ? 'Creating Account...' : 'Signing In...'}</div>) : (isRegistering ? 'Create Account' : 'Sign In')}\n              </button>\n            </div>\n          </form>\n          <div className=\"mt-6\">\n            <div className=\"relative\">\n              <div className=\"absolute inset-0 flex items-center\"><div className=\"w-full border-t border-gray-300\" /></div>\n              <div className=\"relative flex justify-center text-sm\"><span className=\"px-2 bg-white text-gray-500\">{isRegistering ? 'Already have an account?' : \"Don't have an account?\"}</span></div>\n            </div>\n            <div className=\"mt-6\">\n              <button onClick={toggleMode} className=\"w-full flex justify-center py-2 px-4 border border-vibe-cookie text-sm font-medium rounded-md text-vibe-cookie bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-vibe-cookie transition-colors\">{isRegistering ? 'Sign In Instead' : 'Create New Account'}</button>\n            </div>\n          </div>\n          <div className=\"mt-6 text-center\">\n            <Link href=\"/\" className=\"text-sm text-vibe-cookie hover:text-vibe-brown transition-colors\">← Back to Home</Link>\n          </div>\n        </div>\n      </div>\n    </div>\n  )\n}\n\nexport default LoginPage"],"names":[],"mappings":"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","debugId":null}}]
}