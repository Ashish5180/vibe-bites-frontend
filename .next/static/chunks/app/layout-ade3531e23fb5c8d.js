(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[177],{321:(e,t,a)=>{"use strict";a.d(t,{default:()=>d});var r=a(5155),i=a(2115),s=a(5695),o=a(6874),n=a.n(o),l=a(977);let d=()=>{let{items:e}=(0,l._)(),[t,a]=(0,i.useState)(!1),o=(0,s.usePathname)();return((0,i.useEffect)(()=>{a(e.length>0&&"/cart"!==o&&!o.startsWith("/checkout"))},[e,o]),t)?(0,r.jsx)("div",{className:"fixed bottom-0 left-0 w-full z-50 flex justify-center pointer-events-none",children:(0,r.jsxs)("div",{className:"pointer-events-auto bg-vibe-cookie text-vibe-brown px-6 py-3 rounded-t-xl shadow-lg flex items-center gap-4 max-w-md w-full justify-between",children:[(0,r.jsxs)("span",{className:"font-semibold",children:[e.length," item",e.length>1?"s":""," in cart"]}),(0,r.jsx)(n(),{href:"/cart",children:(0,r.jsx)("button",{className:"bg-vibe-brown text-white px-4 py-2 rounded-lg font-semibold hover:bg-vibe-accent transition-colors",children:"Go to Cart"})})]})}):null}},977:(e,t,a)=>{"use strict";a.d(t,{CartProvider:()=>l,_:()=>d});var r=a(5155),i=a(2115),s=a(4938);let o=(0,i.createContext)(),n=(e,t)=>{var a,r;switch(t.type){case"LOAD_CART":return{...e,...t.payload};case"ADD_ITEM":{let r=e.items.find(e=>e.id===t.payload.id&&e.selectedSize===t.payload.selectedSize),i=null!=(a=t.payload.maxStock)?a:99;if(!r)return{...e,items:[...e.items,{...t.payload,quantity:Math.min(t.payload.quantity,i)}]};{let a=Math.min(r.quantity+t.payload.quantity,i);return{...e,items:e.items.map(e=>e.id===t.payload.id&&e.selectedSize===t.payload.selectedSize?{...e,quantity:a}:e)}}}case"REMOVE_ITEM":return{...e,items:e.items.filter(e=>e.id!==t.payload.id||e.selectedSize!==t.payload.selectedSize)};case"UPDATE_QUANTITY":{let a=null!=(r=t.payload.maxStock)?r:99;return{...e,items:e.items.map(e=>e.id===t.payload.id&&e.selectedSize===t.payload.selectedSize?{...e,quantity:Math.min(t.payload.quantity,a)}:e)}}case"CLEAR_CART":return{...e,items:[],appliedCoupon:null};case"APPLY_COUPON":return{...e,appliedCoupon:t.payload};case"REMOVE_COUPON":return{...e,appliedCoupon:null};default:return e}},l=e=>{let{children:t}=e,[a,l]=(0,i.useReducer)(n,{items:[],appliedCoupon:null}),d=()=>{if("undefined"==typeof localStorage)return{"Content-Type":"application/json"};let e=localStorage.getItem("token");return{Authorization:"Bearer ".concat(e),"Content-Type":"application/json"}};(0,i.useEffect)(()=>{if("undefined"==typeof localStorage)return;let e=localStorage.getItem("vibe-bites-cart");e&&l({type:"LOAD_CART",payload:JSON.parse(e)})},[]),(0,i.useEffect)(()=>{"undefined"!=typeof localStorage&&(localStorage.setItem("vibe-bites-cart",JSON.stringify(a)),fetch((0,s.K)("/cart/sync"),{method:"PUT",headers:d(),body:JSON.stringify(a)}).catch(()=>{}))},[a]);let u=(e,t)=>{l({type:"REMOVE_ITEM",payload:{id:e,selectedSize:t}})},c=async e=>{try{let t=await fetch((0,s.K)("/coupons/validate"),{method:"POST",headers:{"Content-Type":"application/json"},headers:d(),body:JSON.stringify({code:e,orderAmount:p(),items:a.items}),headers:d()}),r=await t.json();if(t.ok&&r.success&&r.data&&r.data.coupon)return l({type:"APPLY_COUPON",payload:{code:e.toUpperCase(),...r.data.coupon,discountAmount:r.data.discountAmount}}),{success:!0,message:"Coupon ".concat(e.toUpperCase()," applied!")};return{success:!1,message:r.message||"Invalid coupon code"}}catch(e){return{success:!1,message:"Network error"}}},p=()=>{let e=a.items.reduce((e,t)=>e+t.price*t.quantity,0);if(!a.appliedCoupon)return e;let t=0;return"percentage"===a.appliedCoupon.type&&(t=a.appliedCoupon.category?a.items.filter(e=>e.category===a.appliedCoupon.category).reduce((e,t)=>e+t.price*t.quantity,0)*a.appliedCoupon.discount/100:e*a.appliedCoupon.discount/100),e-t},m={items:a.items,appliedCoupon:a.appliedCoupon,addToCart:function(e,t){var a;let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,i=e.sizes.find(e=>e.size===t)||{},s=i.price||0,o=null!=(a=i.stock)?a:99;l({type:"ADD_ITEM",payload:{id:e.id,name:e.name,image:e.image,selectedSize:t,price:s,quantity:r,category:e.category,maxStock:o}})},removeFromCart:u,updateQuantity:function(e,t,a){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:99;a<=0?u(e,t):l({type:"UPDATE_QUANTITY",payload:{id:e,selectedSize:t,quantity:a,maxStock:r}})},clearCart:()=>{l({type:"CLEAR_CART"})},applyCoupon:c,removeCoupon:()=>{l({type:"REMOVE_COUPON"})},getCartTotal:p,getCartCount:()=>a.items.reduce((e,t)=>e+t.quantity,0)};return(0,r.jsx)(o.Provider,{value:m,children:t})},d=()=>{let e=(0,i.useContext)(o);if(!e)throw Error("useCart must be used within a CartProvider");return e}},4033:(e,t,a)=>{Promise.resolve().then(a.t.bind(a,9324,23)),Promise.resolve().then(a.bind(a,321)),Promise.resolve().then(a.bind(a,5899)),Promise.resolve().then(a.bind(a,977)),Promise.resolve().then(a.bind(a,9930))},4938:(e,t,a)=>{"use strict";a.d(t,{K:()=>i,e:()=>r});let r=()=>"https://vibe-bites-backend.onrender.com/api",i=e=>{let t=r().replace(/\/$/,""),a=e.replace(/^\//,"");return"".concat(t,"/").concat(a)}},5695:(e,t,a)=>{"use strict";var r=a(8999);a.o(r,"useParams")&&a.d(t,{useParams:function(){return r.useParams}}),a.o(r,"usePathname")&&a.d(t,{usePathname:function(){return r.usePathname}}),a.o(r,"useRouter")&&a.d(t,{useRouter:function(){return r.useRouter}}),a.o(r,"useSearchParams")&&a.d(t,{useSearchParams:function(){return r.useSearchParams}})},5899:(e,t,a)=>{"use strict";a.d(t,{ToastProvider:()=>o,d:()=>n});var r=a(5155),i=a(2115);let s=(0,i.createContext)(),o=e=>{let{children:t}=e,[a,o]=(0,i.useState)([]),n=e=>{o(t=>t.filter(t=>t.id!==e))};return(0,r.jsxs)(s.Provider,{value:{addToast:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"success",a=Date.now()+Math.random();o(r=>[...r,{id:a,message:e,type:t}]),setTimeout(()=>{n(a)},3e3)}},children:[t,(0,r.jsx)("div",{className:"fixed top-4 right-4 z-50 space-y-2",children:a.map(e=>(0,r.jsx)("div",{className:"px-4 py-3 rounded-lg shadow-lg max-w-sm transform transition-all duration-300 ".concat("success"===e.type?"bg-green-500 text-white":"error"===e.type?"bg-red-500 text-white":"bg-vibe-cookie text-vibe-brown"),children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsx)("span",{className:"text-sm font-medium",children:e.message}),(0,r.jsx)("button",{onClick:()=>n(e.id),className:"ml-4 text-white hover:text-gray-200",children:"\xd7"})]})},e.id))})]})},n=()=>{let e=(0,i.useContext)(s);if(!e)throw Error("useToast must be used within a ToastProvider");return e}},9324:()=>{},9930:(e,t,a)=>{"use strict";a.d(t,{WishlistProvider:()=>n,n:()=>l});var r=a(5155),i=a(2115);let s=(0,i.createContext)(),o=(e,t)=>{switch(t.type){case"LOAD":return t.payload;case"ADD":if(e.find(e=>e.id===t.payload.id))return e;return[...e,t.payload];case"REMOVE":return e.filter(e=>e.id!==t.payload.id);default:return e}},n=e=>{let{children:t}=e,[a,n]=(0,i.useReducer)(o,[]);return(0,i.useEffect)(()=>{if("undefined"==typeof localStorage)return;let e=localStorage.getItem("vibe-bites-wishlist");e&&n({type:"LOAD",payload:JSON.parse(e)})},[]),(0,i.useEffect)(()=>{"undefined"!=typeof localStorage&&localStorage.setItem("vibe-bites-wishlist",JSON.stringify(a))},[a]),(0,r.jsx)(s.Provider,{value:{items:a,addToWishlist:e=>n({type:"ADD",payload:e}),removeFromWishlist:e=>n({type:"REMOVE",payload:{id:e}})},children:t})},l=()=>{let e=(0,i.useContext)(s);if(!e)throw Error("useWishlist must be used within a WishlistProvider");return e}}},e=>{e.O(0,[533,874,441,964,358],()=>e(e.s=4033)),_N_E=e.O()}]);