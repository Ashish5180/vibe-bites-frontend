(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[230],{5765:(e,s,t)=>{Promise.resolve().then(t.bind(t,7579))},5899:(e,s,t)=>{"use strict";t.d(s,{ToastProvider:()=>c,d:()=>o});var a=t(5155),i=t(2115);let r=(0,i.createContext)(),c=e=>{let{children:s}=e,[t,c]=(0,i.useState)([]),o=e=>{c(s=>s.filter(s=>s.id!==e))};return(0,a.jsxs)(r.Provider,{value:{addToast:function(e){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"success",t=Date.now()+Math.random();c(a=>[...a,{id:t,message:e,type:s}]),setTimeout(()=>{o(t)},3e3)}},children:[s,(0,a.jsx)("div",{className:"fixed top-4 right-4 z-50 space-y-2",children:t.map(e=>(0,a.jsx)("div",{className:"px-4 py-3 rounded-lg shadow-lg max-w-sm transform transition-all duration-300 ".concat("success"===e.type?"bg-green-500 text-white":"error"===e.type?"bg-red-500 text-white":"bg-vibe-cookie text-vibe-brown"),children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("span",{className:"text-sm font-medium",children:e.message}),(0,a.jsx)("button",{onClick:()=>o(e.id),className:"ml-4 text-white hover:text-gray-200",children:"\xd7"})]})},e.id))})]})},o=()=>{let e=(0,i.useContext)(r);if(!e)throw Error("useToast must be used within a ToastProvider");return e}},7579:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>x});var a=t(5155),i=t(9137),r=t.n(i),c=t(2115),o=t(5695),n=t(5899),l=t(7340),d=t(4616),b=t(4416),m=t(1154);let x=()=>{let e=(0,o.useRouter)(),{addToast:s}=(0,n.d)(),[t,i]=(0,c.useState)(null),[x,u]=(0,c.useState)(!0),[f,h]=(0,c.useState)(!1),p="/api",[g,j]=(0,c.useState)([]),v=()=>{let e=localStorage.getItem("token");return{Authorization:"Bearer ".concat(e),"Content-Type":"application/json"}},[N,w]=(0,c.useState)({name:"",description:"",category:"",image:"",images:[""],sizes:[{size:"",price:"",stock:""}],ingredients:"",nutrition:{calories:"",protein:"",carbs:"",fat:"",fiber:""},featured:!1,video:""});(0,c.useEffect)(()=>{(async()=>{try{if(!localStorage.getItem("token"))return void e.push("/login");let t=await fetch("".concat(p,"/auth/me"),{headers:v()});if(!t.ok){localStorage.removeItem("token"),localStorage.removeItem("user"),e.push("/login");return}let a=await t.json();a.success&&"admin"===a.data.role?i(a.data):(s("Admin access required","error"),e.push("/"))}catch(s){localStorage.removeItem("token"),localStorage.removeItem("user"),e.push("/login")}finally{u(!1)}})()},[p,e,s]),(0,c.useEffect)(()=>{(async()=>{try{let e=await fetch("".concat(p,"/categories/all"),{headers:v()});if(e.ok){let s=await e.json();j(s.data.categories.filter(e=>e.isActive)),s.data.categories.length&&!N.category&&w(e=>({...e,category:s.data.categories[0].name}))}}catch(e){s("Error loading categories","error")}})()},[]);let k=(e,s)=>w(t=>({...t,[e]:s})),y=(e,s,t)=>{w(a=>({...a,sizes:a.sizes.map((a,i)=>i===e?{...a,[s]:t}:a)}))},C=async t=>{t.preventDefault();let a=(()=>{let e=[];return N.name.trim()||e.push("Name required"),N.description.trim().length<10&&e.push("Description min 10 chars"),N.image.trim()||e.push("Main image required"),N.ingredients.trim()||e.push("Ingredients required"),N.sizes.forEach((s,t)=>{s.size||e.push("Size #".concat(t+1," label required")),(""===s.price||isNaN(parseFloat(s.price)))&&e.push("Size #".concat(t+1," price invalid")),(""===s.stock||isNaN(parseInt(s.stock)))&&e.push("Size #".concat(t+1," stock invalid"))}),Object.entries(N.nutrition).forEach(s=>{let[t,a]=s;a||e.push("Nutrition ".concat(t," required"))}),e})();if(a.length)return void a.slice(0,6).forEach(e=>s(e,"error"));h(!0);try{var i;let t={...N,sizes:N.sizes.map(e=>({size:e.size.trim(),price:parseFloat(e.price),stock:parseInt(e.stock)})),images:N.images.filter(e=>e.trim()),video:(null==(i=N.video)?void 0:i.trim())||""},a=await fetch("".concat(p,"/admin/products/create"),{method:"POST",headers:v(),body:JSON.stringify(t)}),r=await a.json().catch(()=>({}));a.ok&&r.success?(s("Product created","success"),e.push("/admin")):r.errors?r.errors.slice(0,6).forEach(e=>s(e.msg,"error")):s(r.message||"Create failed","error")}catch(e){s("Network error","error")}finally{h(!1)}};return x?(0,a.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-vibe-bg text-vibe-brown",children:"Checking auth..."}):(0,a.jsxs)("div",{className:"jsx-695e85f7290fbace min-h-screen bg-vibe-bg px-4 py-8 max-w-5xl mx-auto",children:[(0,a.jsxs)("div",{className:"jsx-695e85f7290fbace flex items-center justify-between mb-8",children:[(0,a.jsx)("h1",{className:"jsx-695e85f7290fbace text-3xl font-bold text-vibe-brown",children:"Create Product"}),(0,a.jsxs)("div",{className:"jsx-695e85f7290fbace flex items-center space-x-3",children:[(0,a.jsxs)("button",{onClick:()=>e.push("/"),title:"Go to Home Page",className:"jsx-695e85f7290fbace flex items-center space-x-2 px-4 py-2 rounded-md bg-white border border-vibe-cookie text-vibe-brown hover:bg-vibe-cookie/30 transition-colors",children:[(0,a.jsx)(l.A,{className:"h-4 w-4"}),(0,a.jsx)("span",{className:"jsx-695e85f7290fbace",children:"Home"})]}),(0,a.jsx)("button",{onClick:()=>e.push("/admin"),className:"jsx-695e85f7290fbace px-4 py-2 rounded-md bg-white border border-vibe-cookie text-vibe-brown hover:bg-vibe-cookie/30",children:"Back"})]})]}),(0,a.jsxs)("form",{onSubmit:C,className:"jsx-695e85f7290fbace space-y-8",children:[(0,a.jsxs)("section",{className:"jsx-695e85f7290fbace bg-white border border-vibe-cookie rounded-lg p-6 space-y-4",children:[(0,a.jsx)("h2",{className:"jsx-695e85f7290fbace text-lg font-semibold text-vibe-brown",children:"Basic Info"}),(0,a.jsxs)("div",{className:"jsx-695e85f7290fbace grid md:grid-cols-2 gap-4",children:[(0,a.jsx)("input",{placeholder:"Name",value:N.name,onChange:e=>k("name",e.target.value),className:"jsx-695e85f7290fbace input"}),(0,a.jsx)("select",{value:N.category,onChange:e=>k("category",e.target.value),className:"jsx-695e85f7290fbace input",children:g.map(e=>(0,a.jsx)("option",{value:e.name,className:"jsx-695e85f7290fbace",children:e.name},e._id))}),(0,a.jsx)("input",{placeholder:"Main Image URL",value:N.image,onChange:e=>k("image",e.target.value),className:"jsx-695e85f7290fbace input md:col-span-2"}),(0,a.jsx)("textarea",{rows:3,placeholder:"Description",value:N.description,onChange:e=>k("description",e.target.value),className:"jsx-695e85f7290fbace input md:col-span-2"}),(0,a.jsx)("textarea",{rows:2,placeholder:"Ingredients",value:N.ingredients,onChange:e=>k("ingredients",e.target.value),className:"jsx-695e85f7290fbace input md:col-span-2"}),(0,a.jsx)("input",{placeholder:"Product Video URL (optional)",value:N.video,onChange:e=>k("video",e.target.value),className:"jsx-695e85f7290fbace input md:col-span-2"})]})]}),(0,a.jsxs)("section",{className:"jsx-695e85f7290fbace bg-white border border-vibe-cookie rounded-lg p-6 space-y-4",children:[(0,a.jsxs)("div",{className:"jsx-695e85f7290fbace flex items-center justify-between",children:[(0,a.jsx)("h2",{className:"jsx-695e85f7290fbace text-lg font-semibold text-vibe-brown",children:"Images (optional list)"}),(0,a.jsxs)("button",{type:"button",onClick:()=>w(e=>({...e,images:[...e.images,""]})),className:"jsx-695e85f7290fbace flex items-center gap-1 text-sm px-3 py-1 rounded bg-vibe-cookie text-vibe-brown hover:bg-vibe-brown hover:text-white",children:[(0,a.jsx)(d.A,{className:"h-4 w-4"}),"Add"]})]}),(0,a.jsx)("div",{className:"jsx-695e85f7290fbace space-y-2",children:N.images.map((e,s)=>(0,a.jsxs)("div",{className:"jsx-695e85f7290fbace flex gap-2",children:[(0,a.jsx)("input",{placeholder:"Image URL #".concat(s+1),value:e,onChange:e=>{let t;return t=e.target.value,w(e=>({...e,images:e.images.map((e,a)=>a===s?t:e)}))},className:"jsx-695e85f7290fbace input flex-1"}),N.images.length>1&&(0,a.jsx)("button",{type:"button",onClick:()=>w(e=>({...e,images:e.images.filter((e,t)=>t!==s)})),className:"jsx-695e85f7290fbace px-2 rounded bg-red-100 text-red-700 hover:bg-red-200",children:(0,a.jsx)(b.A,{className:"h-4 w-4"})})]},s))})]}),(0,a.jsxs)("section",{className:"jsx-695e85f7290fbace bg-white border border-vibe-cookie rounded-lg p-6 space-y-4",children:[(0,a.jsxs)("div",{className:"jsx-695e85f7290fbace flex items-center justify-between",children:[(0,a.jsx)("h2",{className:"jsx-695e85f7290fbace text-lg font-semibold text-vibe-brown",children:"Sizes & Pricing"}),(0,a.jsxs)("button",{type:"button",onClick:()=>w(e=>({...e,sizes:[...e.sizes,{size:"",price:"",stock:""}]})),className:"jsx-695e85f7290fbace flex items-center gap-1 text-sm px-3 py-1 rounded bg-vibe-cookie text-vibe-brown hover:bg-vibe-brown hover:text-white",children:[(0,a.jsx)(d.A,{className:"h-4 w-4"}),"Add Size"]})]}),(0,a.jsx)("div",{className:"jsx-695e85f7290fbace space-y-3",children:N.sizes.map((e,s)=>(0,a.jsxs)("div",{className:"jsx-695e85f7290fbace grid md:grid-cols-4 gap-3 items-start",children:[(0,a.jsx)("input",{placeholder:"Size label (e.g. 100g)",value:e.size,onChange:e=>y(s,"size",e.target.value),className:"jsx-695e85f7290fbace input"}),(0,a.jsx)("input",{placeholder:"Price",value:e.price,onChange:e=>y(s,"price",e.target.value),className:"jsx-695e85f7290fbace input"}),(0,a.jsx)("input",{placeholder:"Stock",value:e.stock,onChange:e=>y(s,"stock",e.target.value),className:"jsx-695e85f7290fbace input"}),(0,a.jsx)("div",{className:"jsx-695e85f7290fbace flex items-center",children:N.sizes.length>1&&(0,a.jsx)("button",{type:"button",onClick:()=>w(e=>({...e,sizes:e.sizes.filter((e,t)=>t!==s)})),className:"jsx-695e85f7290fbace px-2 rounded bg-red-100 text-red-700 hover:bg-red-200 h-9",children:(0,a.jsx)(b.A,{className:"h-4 w-4"})})})]},s))})]}),(0,a.jsxs)("section",{className:"jsx-695e85f7290fbace bg-white border border-vibe-cookie rounded-lg p-6 space-y-4",children:[(0,a.jsx)("h2",{className:"jsx-695e85f7290fbace text-lg font-semibold text-vibe-brown",children:"Nutrition"}),(0,a.jsx)("div",{className:"jsx-695e85f7290fbace grid md:grid-cols-5 gap-3",children:Object.keys(N.nutrition).map(e=>(0,a.jsx)("input",{placeholder:e,value:N.nutrition[e],onChange:s=>{let t;return t=s.target.value,w(s=>({...s,nutrition:{...s.nutrition,[e]:t}}))},className:"jsx-695e85f7290fbace input"},e))})]}),(0,a.jsxs)("div",{className:"jsx-695e85f7290fbace pt-2",children:[(0,a.jsx)("div",{className:"jsx-695e85f7290fbace flex items-center gap-4 mb-4",children:(0,a.jsxs)("label",{className:"jsx-695e85f7290fbace flex items-center gap-2 text-vibe-brown font-medium",children:[(0,a.jsx)("input",{type:"checkbox",checked:N.featured,onChange:e=>k("featured",e.target.checked),className:"jsx-695e85f7290fbace"}),"Featured Product"]})}),(0,a.jsxs)("button",{disabled:f,type:"submit",className:"jsx-695e85f7290fbace px-6 py-3 rounded-md bg-vibe-cookie text-vibe-brown font-semibold hover:bg-vibe-brown hover:text-white transition-colors disabled:opacity-50 flex items-center gap-2",children:[f&&(0,a.jsx)(m.A,{className:"h-4 w-4 animate-spin"}),f?"Creating...":"Create Product"]})]})]}),(0,a.jsx)(r(),{id:"695e85f7290fbace",children:".input{@apply px-3 py-2 border border-vibe-cookie rounded-md focus:outline-none focus:ring-2 focus:ring-vibe-cookie bg-white text-vibe-brown placeholder-gray-400;}"})]})}}},e=>{e.O(0,[202,441,964,358],()=>e(e.s=5765)),_N_E=e.O()}]);