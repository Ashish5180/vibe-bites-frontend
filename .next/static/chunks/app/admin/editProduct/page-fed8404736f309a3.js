(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[714],{1154:(e,t,i)=>{"use strict";i.d(t,{A:()=>r});let r=(0,i(9946).A)("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]])},3587:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>h});var r=i(5155),s=i(2115),o=i(5695),a=i(5899),n=i(1154),l=i(5169),c=i(7340),d=i(4616),u=i(4416),m=i(4229);function b(){let e=(0,o.useRouter)(),t=(0,o.useSearchParams)(),{addToast:i}=(0,a.d)(),[b,h]=(0,s.useState)(!0),[x,p]=(0,s.useState)(!1),[v,g]=(0,s.useState)(null),[f,j]=(0,s.useState)([]),[k,w]=(0,s.useState)(null),N="https://vibebitstest-env.eba-ubvupniq.ap-south-1.elasticbeanstalk.com/api",y=t.get("id"),z=()=>{let e=localStorage.getItem("token");return{Authorization:"Bearer ".concat(e),"Content-Type":"application/json"}};(0,s.useEffect)(()=>{(async()=>{if(!y){i("Product ID is required","error"),e.push("/admin");return}try{if(!localStorage.getItem("token")){i("Please login to continue","error"),e.push("/login");return}let s=await fetch("".concat(N,"/auth/me"),{headers:z()});if(!s.ok){localStorage.removeItem("token"),localStorage.removeItem("user"),i("Please login to continue","error"),e.push("/login");return}let o=await s.json();if(!o.success||"admin"!==o.data.role){i("Admin access required","error"),e.push("/");return}g(o.data);let a=await fetch("".concat(N,"/categories/all"),{headers:z()});if(a.ok){var t,r;let e=await a.json();j((null==(r=e.data)||null==(t=r.categories)?void 0:t.filter(e=>e.isActive))||[])}let n=await fetch("".concat(N,"/admin/products/edit/").concat(y),{headers:z()});if(!n.ok){if(404===n.status){i("Product not found","error"),e.push("/admin");return}throw Error("Failed to fetch product")}let l=await n.json();if(l.success)w(l.data.product);else throw Error(l.message||"Failed to fetch product")}catch(t){console.error("Initialization error:",t),i(t.message||"Failed to initialize page","error"),e.push("/admin")}finally{h(!1)}})()},[y,N,e,i]);let[A,P]=(0,s.useState)({name:"",description:"",category:"",image:"",images:[""],sizes:[{size:"",price:"",stock:""}],ingredients:"",nutrition:{calories:"",protein:"",carbs:"",fat:"",fiber:""},featured:!1,video:""});(0,s.useEffect)(()=>{if(k){var e,t;P({name:k.name||"",description:k.description||"",category:k.category||"",image:k.image||"",images:(null==(e=k.images)?void 0:e.length)?k.images:[""],sizes:(null==(t=k.sizes)?void 0:t.length)?k.sizes:[{size:"",price:"",stock:""}],ingredients:k.ingredients||"",nutrition:k.nutrition||{calories:"",protein:"",carbs:"",fat:"",fiber:""},featured:!!k.featured,video:k.video||""})}},[k]);let C=(e,t)=>{P(i=>({...i,[e]:t}))},S=(e,t,i)=>{P(r=>({...r,sizes:r.sizes.map((r,s)=>s===e?{...r,[t]:i}:r)}))},E=async t=>{t.preventDefault(),p(!0);try{var r;if(!A.name.trim()||!A.description.trim()||!A.category.trim()||!A.image.trim())return void i("Please fill in all required fields","error");if(!A.sizes.length||A.sizes.some(e=>!e.size.trim()||!e.price||""===e.stock))return void i("Please fill in all size details","error");if(!A.ingredients.trim())return void i("Please fill in ingredients","error");let t={name:A.name.trim(),description:A.description.trim(),category:A.category.trim(),image:A.image.trim(),images:A.images.filter(e=>e.trim()),sizes:A.sizes.map(e=>({size:e.size.trim(),price:parseFloat(e.price),stock:parseInt(e.stock)})),ingredients:A.ingredients.trim(),nutrition:{calories:A.nutrition.calories||"",protein:A.nutrition.protein||"",carbs:A.nutrition.carbs||"",fat:A.nutrition.fat||"",fiber:A.nutrition.fiber||""},featured:A.featured,video:(null==(r=A.video)?void 0:r.trim())||""},s=await fetch("".concat(N,"/admin/products/edit/").concat(y),{method:"PUT",headers:z(),body:JSON.stringify(t)}),o=await s.json();s.ok&&o.success?(i("Product updated successfully!","success"),e.push("/admin")):i(o.message||"Failed to update product","error")}catch(e){console.error("Update error:",e),i("Network error. Please try again.","error")}finally{p(!1)}};return b?(0,r.jsx)("div",{className:"min-h-screen bg-vibe-bg flex items-center justify-center",children:(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)(n.A,{className:"h-8 w-8 animate-spin text-vibe-brown mx-auto mb-4"}),(0,r.jsx)("p",{className:"text-vibe-brown text-lg",children:"Loading product..."})]})}):k?(0,r.jsx)("div",{className:"min-h-screen bg-vibe-bg px-4 py-8",children:(0,r.jsxs)("div",{className:"max-w-6xl mx-auto",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-8",children:[(0,r.jsxs)("div",{className:"flex items-center gap-4",children:[(0,r.jsx)("button",{onClick:()=>e.push("/admin"),className:"p-2 rounded-full bg-white border border-vibe-cookie text-vibe-brown hover:bg-vibe-cookie/30",children:(0,r.jsx)(l.A,{className:"h-5 w-5"})}),(0,r.jsx)("h1",{className:"text-3xl font-bold text-vibe-brown",children:"Edit Product"})]}),(0,r.jsxs)("button",{onClick:()=>e.push("/"),className:"flex items-center space-x-2 px-4 py-2 rounded-md bg-white border border-vibe-cookie text-vibe-brown hover:bg-vibe-cookie/30 transition-colors",title:"Go to Home Page",children:[(0,r.jsx)(c.A,{className:"h-4 w-4"}),(0,r.jsx)("span",{children:"Home"})]})]}),(0,r.jsxs)("form",{onSubmit:E,className:"space-y-8",children:[(0,r.jsxs)("div",{className:"bg-white rounded-lg border border-vibe-cookie p-6",children:[(0,r.jsx)("h2",{className:"text-xl font-semibold text-vibe-brown mb-6",children:"Basic Information"}),(0,r.jsxs)("div",{className:"grid md:grid-cols-2 gap-6",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-vibe-brown mb-2",children:"Product Name *"}),(0,r.jsx)("input",{type:"text",value:A.name,onChange:e=>C("name",e.target.value),className:"w-full px-3 py-2 border border-vibe-cookie rounded-md focus:outline-none focus:ring-2 focus:ring-vibe-cookie",placeholder:"Enter product name",required:!0})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-vibe-brown mb-2",children:"Category *"}),(0,r.jsxs)("select",{value:A.category,onChange:e=>C("category",e.target.value),className:"w-full px-3 py-2 border border-vibe-cookie rounded-md focus:outline-none focus:ring-2 focus:ring-vibe-cookie",required:!0,children:[(0,r.jsx)("option",{value:"",children:"Select category"}),f.map(e=>(0,r.jsx)("option",{value:e.name,children:e.name},e._id))]})]}),(0,r.jsxs)("div",{className:"md:col-span-2",children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-vibe-brown mb-2",children:"Description *"}),(0,r.jsx)("textarea",{value:A.description,onChange:e=>C("description",e.target.value),rows:4,className:"w-full px-3 py-2 border border-vibe-cookie rounded-md focus:outline-none focus:ring-2 focus:ring-vibe-cookie",placeholder:"Enter product description",required:!0})]}),(0,r.jsxs)("div",{className:"md:col-span-2",children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-vibe-brown mb-2",children:"Main Image URL *"}),(0,r.jsx)("input",{type:"url",value:A.image,onChange:e=>C("image",e.target.value),className:"w-full px-3 py-2 border border-vibe-cookie rounded-md focus:outline-none focus:ring-2 focus:ring-vibe-cookie",placeholder:"https://example.com/image.jpg",required:!0})]}),(0,r.jsxs)("div",{className:"md:col-span-2",children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-vibe-brown mb-2",children:"Ingredients *"}),(0,r.jsx)("textarea",{value:A.ingredients,onChange:e=>C("ingredients",e.target.value),rows:3,className:"w-full px-3 py-2 border border-vibe-cookie rounded-md focus:outline-none focus:ring-2 focus:ring-vibe-cookie",placeholder:"Enter ingredients list",required:!0})]}),(0,r.jsxs)("div",{className:"md:col-span-2",children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-vibe-brown mb-2",children:"Product Video URL (optional)"}),(0,r.jsx)("input",{type:"url",value:A.video,onChange:e=>C("video",e.target.value),className:"w-full px-3 py-2 border border-vibe-cookie rounded-md focus:outline-none focus:ring-2 focus:ring-vibe-cookie",placeholder:"https://example.com/video.mp4"})]})]})]}),(0,r.jsxs)("div",{className:"bg-white rounded-lg border border-vibe-cookie p-6",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,r.jsx)("h2",{className:"text-xl font-semibold text-vibe-brown",children:"Additional Images"}),(0,r.jsxs)("button",{type:"button",onClick:()=>{P(e=>({...e,images:[...e.images,""]}))},className:"flex items-center gap-2 px-4 py-2 bg-vibe-cookie text-vibe-brown rounded-md hover:bg-vibe-brown hover:text-white",children:[(0,r.jsx)(d.A,{className:"h-4 w-4"}),"Add Image"]})]}),(0,r.jsx)("div",{className:"space-y-3",children:A.images.map((e,t)=>(0,r.jsxs)("div",{className:"flex gap-3",children:[(0,r.jsx)("input",{type:"url",value:e,onChange:e=>{var i;return i=e.target.value,void P(e=>({...e,images:e.images.map((e,r)=>r===t?i:e)}))},className:"flex-1 px-3 py-2 border border-vibe-cookie rounded-md focus:outline-none focus:ring-2 focus:ring-vibe-cookie",placeholder:"Additional image URL ".concat(t+1)}),A.images.length>1&&(0,r.jsx)("button",{type:"button",onClick:()=>{A.images.length>1&&P(e=>({...e,images:e.images.filter((e,i)=>i!==t)}))},className:"px-3 py-2 bg-red-100 text-red-700 rounded-md hover:bg-red-200",children:(0,r.jsx)(u.A,{className:"h-4 w-4"})})]},t))})]}),(0,r.jsxs)("div",{className:"bg-white rounded-lg border border-vibe-cookie p-6",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,r.jsx)("h2",{className:"text-xl font-semibold text-vibe-brown",children:"Sizes & Pricing *"}),(0,r.jsxs)("button",{type:"button",onClick:()=>{P(e=>({...e,sizes:[...e.sizes,{size:"",price:"",stock:""}]}))},className:"flex items-center gap-2 px-4 py-2 bg-vibe-cookie text-vibe-brown rounded-md hover:bg-vibe-brown hover:text-white",children:[(0,r.jsx)(d.A,{className:"h-4 w-4"}),"Add Size"]})]}),(0,r.jsx)("div",{className:"space-y-4",children:A.sizes.map((e,t)=>(0,r.jsxs)("div",{className:"grid md:grid-cols-4 gap-4 items-end",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-vibe-brown mb-2",children:"Size Label"}),(0,r.jsx)("input",{type:"text",value:e.size,onChange:e=>S(t,"size",e.target.value),className:"w-full px-3 py-2 border border-vibe-cookie rounded-md focus:outline-none focus:ring-2 focus:ring-vibe-cookie",placeholder:"e.g., 100g",required:!0})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-vibe-brown mb-2",children:"Price (₹)"}),(0,r.jsx)("input",{type:"number",step:"0.01",min:"0",value:e.price,onChange:e=>S(t,"price",e.target.value),className:"w-full px-3 py-2 border border-vibe-cookie rounded-md focus:outline-none focus:ring-2 focus:ring-vibe-cookie",placeholder:"0.00",required:!0})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-vibe-brown mb-2",children:"Stock"}),(0,r.jsx)("input",{type:"number",min:"0",value:e.stock,onChange:e=>S(t,"stock",e.target.value),className:"w-full px-3 py-2 border border-vibe-cookie rounded-md focus:outline-none focus:ring-2 focus:ring-vibe-cookie",placeholder:"0",required:!0})]}),(0,r.jsx)("div",{children:A.sizes.length>1&&(0,r.jsx)("button",{type:"button",onClick:()=>{A.sizes.length>1&&P(e=>({...e,sizes:e.sizes.filter((e,i)=>i!==t)}))},className:"w-full px-3 py-2 bg-red-100 text-red-700 rounded-md hover:bg-red-200",children:(0,r.jsx)(u.A,{className:"h-4 w-4 mx-auto"})})})]},t))})]}),(0,r.jsxs)("div",{className:"bg-white rounded-lg border border-vibe-cookie p-6",children:[(0,r.jsx)("h2",{className:"text-xl font-semibold text-vibe-brown mb-6",children:"Nutrition Information"}),(0,r.jsx)("div",{className:"grid md:grid-cols-5 gap-4",children:Object.entries(A.nutrition).map(e=>{let[t,i]=e;return(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-vibe-brown mb-2 capitalize",children:t}),(0,r.jsx)("input",{type:"text",value:i,onChange:e=>{var i;return i=e.target.value,void P(e=>({...e,nutrition:{...e.nutrition,[t]:i}}))},className:"w-full px-3 py-2 border border-vibe-cookie rounded-md focus:outline-none focus:ring-2 focus:ring-vibe-cookie",placeholder:t})]},t)})})]}),(0,r.jsx)("div",{className:"bg-white rounded-lg border border-vibe-cookie p-6",children:(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[(0,r.jsx)("input",{type:"checkbox",id:"featured",checked:A.featured,onChange:e=>C("featured",e.target.checked),className:"w-4 h-4 text-vibe-cookie border-vibe-cookie rounded focus:ring-vibe-cookie"}),(0,r.jsx)("label",{htmlFor:"featured",className:"text-lg font-medium text-vibe-brown",children:"Mark as Featured Product"})]})}),(0,r.jsxs)("div",{className:"flex justify-end gap-4",children:[(0,r.jsx)("button",{type:"button",onClick:()=>e.push("/admin"),className:"px-6 py-3 border border-vibe-cookie text-vibe-brown rounded-md hover:bg-vibe-cookie/30",children:"Cancel"}),(0,r.jsx)("button",{type:"submit",disabled:x,className:"flex items-center gap-2 px-6 py-3 bg-vibe-cookie text-vibe-brown font-semibold rounded-md hover:bg-vibe-brown hover:text-white disabled:opacity-50",children:x?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.A,{className:"h-4 w-4 animate-spin"}),"Updating..."]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(m.A,{className:"h-4 w-4"}),"Update Product"]})})]})]})]})}):(0,r.jsx)("div",{className:"min-h-screen bg-vibe-bg flex items-center justify-center",children:(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("p",{className:"text-vibe-brown text-lg mb-4",children:"Product not found"}),(0,r.jsx)("button",{onClick:()=>e.push("/admin"),className:"px-4 py-2 bg-vibe-cookie text-vibe-brown rounded-md hover:bg-vibe-brown hover:text-white",children:"Back to Admin"})]})})}let h=()=>(0,r.jsx)(s.Suspense,{fallback:(0,r.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-vibe-bg text-vibe-brown",children:"Loading..."}),children:(0,r.jsx)(b,{})})},4229:(e,t,i)=>{"use strict";i.d(t,{A:()=>r});let r=(0,i(9946).A)("Save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]])},4416:(e,t,i)=>{"use strict";i.d(t,{A:()=>r});let r=(0,i(9946).A)("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]])},4616:(e,t,i)=>{"use strict";i.d(t,{A:()=>r});let r=(0,i(9946).A)("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]])},5169:(e,t,i)=>{"use strict";i.d(t,{A:()=>r});let r=(0,i(9946).A)("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]])},5695:(e,t,i)=>{"use strict";var r=i(8999);i.o(r,"useParams")&&i.d(t,{useParams:function(){return r.useParams}}),i.o(r,"usePathname")&&i.d(t,{usePathname:function(){return r.usePathname}}),i.o(r,"useRouter")&&i.d(t,{useRouter:function(){return r.useRouter}}),i.o(r,"useSearchParams")&&i.d(t,{useSearchParams:function(){return r.useSearchParams}})},5899:(e,t,i)=>{"use strict";i.d(t,{ToastProvider:()=>a,d:()=>n});var r=i(5155),s=i(2115);let o=(0,s.createContext)(),a=e=>{let{children:t}=e,[i,a]=(0,s.useState)([]),n=e=>{a(t=>t.filter(t=>t.id!==e))};return(0,r.jsxs)(o.Provider,{value:{addToast:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"success",i=Date.now()+Math.random();a(r=>[...r,{id:i,message:e,type:t}]),setTimeout(()=>{n(i)},3e3)}},children:[t,(0,r.jsx)("div",{className:"fixed top-4 right-4 z-50 space-y-2",children:i.map(e=>(0,r.jsx)("div",{className:"px-4 py-3 rounded-lg shadow-lg max-w-sm transform transition-all duration-300 ".concat("success"===e.type?"bg-green-500 text-white":"error"===e.type?"bg-red-500 text-white":"bg-vibe-cookie text-vibe-brown"),children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsx)("span",{className:"text-sm font-medium",children:e.message}),(0,r.jsx)("button",{onClick:()=>n(e.id),className:"ml-4 text-white hover:text-gray-200",children:"\xd7"})]})},e.id))})]})},n=()=>{let e=(0,s.useContext)(o);if(!e)throw Error("useToast must be used within a ToastProvider");return e}},7340:(e,t,i)=>{"use strict";i.d(t,{A:()=>r});let r=(0,i(9946).A)("House",[["path",{d:"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8",key:"5wwlr5"}],["path",{d:"M3 10a2 2 0 0 1 .709-1.528l7-5.999a2 2 0 0 1 2.582 0l7 5.999A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"1d0kgt"}]])},8653:(e,t,i)=>{Promise.resolve().then(i.bind(i,3587))},9946:(e,t,i)=>{"use strict";i.d(t,{A:()=>n});var r=i(2115);let s=function(){for(var e=arguments.length,t=Array(e),i=0;i<e;i++)t[i]=arguments[i];return t.filter((e,t,i)=>!!e&&i.indexOf(e)===t).join(" ")};var o={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let a=(0,r.forwardRef)((e,t)=>{let{color:i="currentColor",size:a=24,strokeWidth:n=2,absoluteStrokeWidth:l,className:c="",children:d,iconNode:u,...m}=e;return(0,r.createElement)("svg",{ref:t,...o,width:a,height:a,stroke:i,strokeWidth:l?24*Number(n)/Number(a):n,className:s("lucide",c),...m},[...u.map(e=>{let[t,i]=e;return(0,r.createElement)(t,i)}),...Array.isArray(d)?d:[d]])}),n=(e,t)=>{let i=(0,r.forwardRef)((i,o)=>{let{className:n,...l}=i;return(0,r.createElement)(a,{ref:o,iconNode:t,className:s("lucide-".concat(e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase()),n),...l})});return i.displayName="".concat(e),i}}},e=>{e.O(0,[441,964,358],()=>e(e.s=8653)),_N_E=e.O()}]);